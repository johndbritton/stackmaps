(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 - 2012 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
 Note: The Google Maps API v3 must be included *before* this code
*/
var i=null;
(function(){var s,t={}.hasOwnProperty,u=[].slice;if(((s=this.google)!=i?s.maps:void 0)!=i)this.OverlappingMarkerSpiderfier=function(){function n(c,d){var a,e,g,f,b=this;this.map=c;d==i&&(d={});for(a in d)t.call(d,a)&&(e=d[a],this[a]=e);this.m=new this.constructor.c(this.map);this.i();this.b={};f=["click","zoom_changed","maptypeid_changed"];e=0;for(g=f.length;e<g;e++)a=f[e],k.addListener(this.map,a,function(){return b.unspiderfy()})}var k,o,m,q,h,b,r;b=n.prototype;b.VERSION="0.2.4";o=google.maps;k=
o.event;h=o.MapTypeId;r=2*Math.PI;b.keepSpiderfied=!1;b.markersWontHide=!1;b.markersWontMove=!1;b.nearbyDistance=20;b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=r/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};q=b.legColors.usual;m=b.legColors.highlighted;q[h.HYBRID]=q[h.SATELLITE]="#fff";m[h.HYBRID]=m[h.SATELLITE]="#f00";
q[h.TERRAIN]=q[h.ROADMAP]="#444";m[h.TERRAIN]=m[h.ROADMAP]="#f00";b.i=function(){this.a=[];this.f=[]};b.addMarker=function(c){var d,a=this;d=[k.addListener(c,"click",function(){return a.B(c)})];this.markersWontHide||d.push(k.addListener(c,"visible_changed",function(){return a.k(c,!1)}));this.markersWontMove||d.push(k.addListener(c,"position_changed",function(){return a.k(c,!0)}));this.f.push(d);this.a.push(c);return this};b.k=function(c,d){if(c._omsData!=i&&(d||!c.getVisible())&&!(this.p!=i||this.q!=
i))return this.F(d?c:i)};b.getMarkers=function(){return this.a.slice(0,this.a.length)};b.removeMarker=function(c){var d,a,e,g;c._omsData!=i&&this.unspiderfy();c=this.h(this.a,c);if(!(0>c)){a=this.f.splice(c,1)[0];e=0;for(g=a.length;e<g;e++)d=a[e],k.removeListener(d);this.a.splice(c,1);return this}};b.clearMarkers=function(){var c,d,a,e,g,f,b;this.unspiderfy();b=this.f;a=0;for(g=b.length;a<g;a++){d=b[a];e=0;for(f=d.length;e<f;e++)c=d[e],k.removeListener(c)}this.i();return this};b.addListener=function(c,
d){var a,e;((e=(a=this.b)[c])!=i?e:a[c]=[]).push(d);return this};b.removeListener=function(c,d){var a;a=this.h(this.b[c],d);0>a||this.b[c].splice(a,1);return this};b.clearListeners=function(c){this.b[c]=[];return this};b.trigger=function(){var c,d,a,e,g,b;d=arguments[0];c=2<=arguments.length?u.call(arguments,1):[];d=(a=this.b[d])!=i?a:[];b=[];e=0;for(g=d.length;e<g;e++)a=d[e],b.push(a.apply(i,c));return b};b.r=function(c,d){var a,e,b,f,j;b=this.circleFootSeparation*(2+c)/r;e=r/c;j=[];for(a=f=0;0<=
c?f<c:f>c;a=0<=c?++f:--f)a=this.circleStartAngle+a*e,j.push(new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)));return j};b.s=function(c,d){var a,e,b,f,j;b=this.spiralLengthStart;a=0;j=[];for(e=f=0;0<=c?f<c:f>c;e=0<=c?++f:--f)a+=this.spiralFootSeparation/b+5.0E-4*e,e=new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)),b+=r*this.spiralLengthFactor/a,j.push(e);return j};b.B=function(c){var d,a,b,g,f,j,p,l,k;d=c._omsData!=i;(!d||!this.keepSpiderfied)&&this.unspiderfy();if(d)return this.trigger("click",c);
g=[];f=[];j=this.nearbyDistance*this.nearbyDistance;b=this.j(c.position);k=this.a;p=0;for(l=k.length;p<l;p++)d=k[p],d.getVisible()&&d.map!=i&&(a=this.j(d.position),this.n(a,b)<j?g.push({v:d,l:a}):f.push(d));return 1===g.length?this.trigger("click",c):this.C(g,f)};b.u=function(c){var d=this;return{d:function(){return c._omsData.e.setOptions({strokeColor:d.legColors.highlighted[d.map.mapTypeId],zIndex:d.highlightedLegZIndex})},g:function(){return c._omsData.e.setOptions({strokeColor:d.legColors.usual[d.map.mapTypeId],
zIndex:d.usualLegZIndex})}}};b.C=function(c,d){var a,b,g,f,j,p,l,h,n,m;this.p=!0;m=c.length;a=this.z(function(){var a,d,b;b=[];a=0;for(d=c.length;a<d;a++)h=c[a],b.push(h.l);return b}());f=m>=this.circleSpiralSwitchover?this.s(m,a).reverse():this.r(m,a);a=function(){var a,d,h,m=this;h=[];a=0;for(d=f.length;a<d;a++)g=f[a],b=this.A(g),n=this.w(c,function(a){return m.n(a.l,g)}),l=n.v,p=new o.Polyline({map:this.map,path:[l.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,
zIndex:this.usualLegZIndex}),l._omsData={D:l.position,e:p},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(j=this.u(l),l._omsData.t={d:k.addListener(l,"mouseover",j.d),g:k.addListener(l,"mouseout",j.g)}),l.setPosition(b),l.setZIndex(Math.round(this.spiderfiedZIndex+g.y)),h.push(l);return h}.call(this);delete this.p;this.o=!0;return this.trigger("spiderfy",a,d)};b.unspiderfy=function(c){var d,a,b,g,f,j,h;c==i&&(c=i);if(this.o!=i){this.q=!0;g=[];b=[];h=this.a;
f=0;for(j=h.length;f<j;f++)a=h[f],a._omsData!=i?(a._omsData.e.setMap(i),a!==c&&a.setPosition(a._omsData.D),a.setZIndex(i),d=a._omsData.t,d!=i&&(k.removeListener(d.d),k.removeListener(d.g)),delete a._omsData,g.push(a)):b.push(a);delete this.q;delete this.o;this.trigger("unspiderfy",g,b);return this}};b.n=function(c,d){var a,b;a=c.x-d.x;b=c.y-d.y;return a*a+b*b};b.z=function(c){var b,a,e,g,f;g=a=e=0;for(f=c.length;g<f;g++)b=c[g],a+=b.x,e+=b.y;c=c.length;return new o.Point(a/c,e/c)};b.j=function(c){return this.m.getProjection().fromLatLngToDivPixel(c)};
b.A=function(c){return this.m.getProjection().fromDivPixelToLatLng(c)};b.w=function(c,b){var a,e,g,f,j,h;g=j=0;for(h=c.length;j<h;g=++j)if(f=c[g],f=b(f),!("undefined"!==typeof a&&a!==i)||f<e)e=f,a=g;return c.splice(a,1)[0]};b.h=function(c,b){var a,e,g,f;if(c.indexOf!=i)return c.indexOf(b);a=g=0;for(f=c.length;g<f;a=++g)if(e=c[a],e===b)return a;return-1};n.c=function(b){return this.setMap(b)};n.c.prototype=new o.OverlayView;n.c.prototype.draw=function(){};return n}()}).call(this);}).call(this);
/* Thu 12 Apr 2012 18:41:52 BST */
